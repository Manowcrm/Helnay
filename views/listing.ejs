<div class="row">
	<div class="col-md-7">
		<% if (images && images.length > 0) { %>
			<div id="listingCarousel" class="carousel slide" data-bs-ride="carousel">
				<div class="carousel-inner">
					<% images.forEach(function(img, idx){ %>
						<div class="carousel-item <%= idx === 0 ? 'active' : '' %>">
							<img src="<%= img.url %>" class="d-block w-100" style="height:420px; object-fit:cover;" />
						</div>
					<% }) %>
				</div>
				<button class="carousel-control-prev" type="button" data-bs-target="#listingCarousel" data-bs-slide="prev">
					<span class="carousel-control-prev-icon" aria-hidden="true"></span>
					<span class="visually-hidden">Previous</span>
				</button>
				<button class="carousel-control-next" type="button" data-bs-target="#listingCarousel" data-bs-slide="next">
					<span class="carousel-control-next-icon" aria-hidden="true"></span>
					<span class="visually-hidden">Next</span>
				</button>
			</div>
		<% } else { %>
			<div class="border" style="height:420px; display:flex; align-items:center; justify-content:center; background:#f8f9fa;">No photos</div>
		<% } %>
	</div>
	<div class="col-md-5">
		<h1 class="mb-3"><%= listing.title %></h1>
		<p class="text-muted mb-2"><i class="bi bi-geo-alt-fill"></i> <strong><%= listing.location %></strong></p>
		<h3 class="text-primary mb-4">$<%= listing.price %> <small class="text-muted">/ night</small></h3>
		
		<h5 class="mb-3">Description</h5>
		<p class="mb-4"><%= listing.description %></p>
		
		<% 
		const desc = listing.description.toLowerCase();
		const amenities = [];
		// Services matching the sidebar filters
		if (desc.includes('pool')) amenities.push({ icon: 'water', text: 'Pool' });
		if (desc.includes('wifi')) amenities.push({ icon: 'wifi', text: 'WiFi' });
		if (desc.includes('balcony') || desc.includes('patio') || desc.includes('terrace')) amenities.push({ icon: 'building', text: 'Balcony/Patio' });
		if (desc.includes('air conditioning')) amenities.push({ icon: 'snow', text: 'Air Conditioning' });
		if (desc.includes('garden') || desc.includes('yard')) amenities.push({ icon: 'flower1', text: 'Garden' });
		if (desc.includes('tv')) amenities.push({ icon: 'tv', text: 'TV' });
		if (desc.includes('parking') || desc.includes('garage')) amenities.push({ icon: 'car-front', text: 'Parking' });
		if (desc.includes('kitchen')) amenities.push({ icon: 'cup-hot', text: 'Kitchen' });
		if (desc.includes('washing machine') || desc.includes('washing')) amenities.push({ icon: 'recycle', text: 'Washing Machine' });
		if (desc.includes('microwave')) amenities.push({ icon: 'lightning', text: 'Microwave' });
		if (desc.includes('dishwasher')) amenities.push({ icon: 'droplet', text: 'Dishwasher' });
		if (desc.includes('hot tub')) amenities.push({ icon: 'tsunami', text: 'Hot Tub' });
		if (desc.includes('sauna')) amenities.push({ icon: 'fire', text: 'Sauna' });
		if (desc.includes('fireplace')) amenities.push({ icon: 'fire', text: 'Fireplace' });
		if (desc.includes('cot') || desc.includes('crib')) amenities.push({ icon: 'moon', text: 'Cot' });
		if (desc.includes('pet-friend')) amenities.push({ icon: 'heart', text: 'Pet-Friendly' });
		if (desc.includes('no smoking') || desc.includes('smoke-free')) amenities.push({ icon: 'slash-circle', text: 'No Smoking' });
		if (desc.includes('no pet')) amenities.push({ icon: 'x-circle', text: 'No Pets' });
		if (desc.includes('wheelchair accessible')) amenities.push({ icon: 'person-wheelchair', text: 'Wheelchair Access' });
		if (desc.includes('fishing')) amenities.push({ icon: 'life-preserver', text: 'Fishing' });
		if (desc.includes('bbq') || desc.includes('grill')) amenities.push({ icon: 'fire', text: 'Grill' });
		%>
		
		<% if (amenities.length > 0) { %>
		<h5 class="mb-3">Amenities</h5>
		<div class="row mb-4">
			<% amenities.forEach(function(amenity) { %>
				<div class="col-6 col-md-6 mb-2">
					<i class="bi bi-<%= amenity.icon %> text-primary"></i> <%= amenity.text %>
				</div>
			<% }); %>
		</div>
		<% } %>
		
		<div class="d-grid gap-2 mt-4">
			<a class="btn btn-success btn-lg" href="/bookings?listing_id=<%= listing.id %>">
				<i class="bi bi-calendar-check"></i> Rent This Property
			</a>
			<a class="btn btn-outline-secondary" href="/contact">
				<i class="bi bi-envelope"></i> Contact Owner
			</a>
		</div>
	</div>
</div>
